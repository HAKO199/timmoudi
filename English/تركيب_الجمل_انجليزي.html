<!doctype html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Ù„Ø¹Ø¨Ø© ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© â€” 100 Ø¬Ù…Ù„Ø©</title>
<style>
  :root{
    --bg:#e8fff0;
    --panel:#ffffff;
    --text:#04313a;
    --muted:#4b6b75;
    --green:#059669;
    --accent1:#06b6d4; --accent2:#3b82f6; --accent3:#f97316; --accent4:#ef4444;
    --radius:14px;
  }
  *{box-sizing:border-box}
  body{margin:0;font-family:'Tajawal',system-ui,Segoe UI,Roboto,Arial;background:linear-gradient(180deg,#e8fff0,#f0fff9);color:var(--text);-webkit-font-smoothing:antialiased;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
  .wrap{width:100%;max-width:980px}
  header{display:flex;align-items:center;gap:12px;margin-bottom:14px}
  .logo{width:64px;height:64;border-radius:14px;display:grid;place-items:center;color:#fff;font-weight:900;background:linear-gradient(135deg,var(--accent1),var(--accent2));font-size:18px}
  h1{margin:0;font-size:20px}
  .meta{color:var(--muted);font-size:13px}

  /* rainbow border panel */
  .game-panel{
    background:var(--panel);
    border-radius:calc(var(--radius) + 8px);
    padding:14px;
    position:relative;
    overflow:visible;
  }
  .rainbow-frame{
    border-radius:calc(var(--radius) + 8px);
    padding:6px;
    background: linear-gradient(90deg, #ff5f6d, #ffc371, #47b78a, #06b6d4, #3b82f6, #9b5de5);
  }
  .panel-inner{
    border-radius:var(--radius);
    background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.98));
    padding:18px;
    box-shadow:0 18px 40px rgba(2,6,23,0.06);
  }

  .top-row{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
  .progress{display:flex;align-items:center;gap:12px}
  .meter{width:260px;height:10px;background:#eefaf5;border-radius:999px;overflow:hidden;border:1px solid rgba(4,49,58,0.04)}
  .meter > i{display:block;height:100%;background:linear-gradient(90deg,var(--green),var(--accent2));width:0%}
  .score{font-weight:800}

  .game-area{margin-top:14px;display:flex;flex-direction:column;gap:12px;align-items:stretch}
  .translation{font-weight:800;color:var(--green);font-size:18px}
  .prompt{font-weight:900;font-size:22px;color:var(--text)}
  .slot-row{display:flex;flex-wrap:wrap;gap:8px;padding:12px;border-radius:12px;border:2px dashed rgba(4,49,58,0.06);min-height:64px;align-items:center;justify-content:center;transition:transform .18s,box-shadow .18s}
  .slot{min-width:64px;min-height:40px;padding:8px 12px;border-radius:999px;border:1px dashed rgba(4,49,58,0.06);display:flex;align-items:center;justify-content:center;background:transparent;color:var(--text);cursor:pointer}
  .slot.placed{background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;border:0}

  .pool{display:flex;flex-wrap:wrap;gap:8px;padding:12px;border-radius:12px;background:linear-gradient(180deg,#fff,#fbfffd);border:1px solid rgba(4,49,58,0.04)}
  .word-pill{padding:8px 12px;border-radius:999px;background:#fff;border:1px solid rgba(4,49,58,0.06);cursor:pointer;user-select:none;box-shadow:0 6px 18px rgba(2,6,23,0.03)}
  .word-pill.dragging{opacity:.5;transform:scale(.98)}

  .controls{display:flex;gap:8px;align-items:center;justify-content:space-between;flex-wrap:wrap;margin-top:8px}
  .btn{padding:8px 12px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--accent1),var(--accent2));color:#fff;font-weight:800;cursor:pointer}
  .btn.ghost{background:#fff;color:var(--muted);border:1px solid rgba(4,49,58,0.06)}
  .check-btn{background:linear-gradient(90deg,#16a34a,#059669)}

  .feedback{font-weight:800;min-height:26px}
  .feedback.ok{color:var(--green)}
  .feedback.bad{color:var(--accent4)}

  /* confetti canvas absolute */
  #confettiCanvas{position:fixed;left:0;top:0;pointer-events:none;z-index:9999}

  /* final modal */
  .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(0,0,0,0.45);z-index:10000}
  .modal.open{display:flex}
  .modal-box{background:#fff;padding:22px;border-radius:12px;max-width:720px;width:94%;text-align:center}
  .rating{font-weight:900;font-size:22px;color:var(--green)}
  .celebrate-emoji{font-size:48px;margin-top:10px}

  /* responsive */
  @media(max-width:800px){
    .meter{width:160px}
    .prompt{font-size:18px}
  }
</style>
</head>
<body>
  <canvas id="confettiCanvas"></canvas>
  <div class="wrap">
    <header style="display:flex;align-items:center;gap:12px">
      <div class="logo">EN</div>
      <div>
        <h1>Ù„Ø¹Ø¨Ø© ØªØ±ÙƒÙŠØ¨ Ø§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© â€” 100 Ø¬Ù…Ù„Ø©</h1>
        <div class="meta">Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© ØªØ¸Ù‡Ø± Ù„Ù„Ù…Ø³Ø§Ø¹Ø¯Ø© â€” Ø§Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø¨Ø§Ù„ØªØ±ØªÙŠØ¨ Ø§Ù„ØµØ­ÙŠØ­</div>
      </div>
    </header>

    <div class="game-panel rainbow-frame">
      <div class="panel-inner">

        <div class="top-row">
          <div class="progress">
            <div style="font-weight:800">Ø§Ù„ØªÙ‚Ø¯Ù‘Ù…</div>
            <div class="meter"><i id="meterBar"></i></div>
            <div class="score" id="progressText">0 / 100</div>
          </div>

          <div style="text-align:left">
            <div>ØµÙˆØª: <button id="muteToggle" class="btn ghost">ğŸ”Š ØªØ´ØºÙŠÙ„</button></div>
          </div>
        </div>

        <div class="game-area">
          <div class="translation" id="sentenceTranslation">...</div>
          <div class="prompt" id="sentencePrompt">...</div>

          <div class="slot-row" id="slotRow" aria-label="slots"></div>

          <div class="pool" id="wordPool" aria-label="pool"></div>

          <div class="controls">
            <div style="display:flex;gap:8px;align-items:center">
              <button id="shuffleBtn" class="btn ghost">ğŸ”€ Ø®Ù„Ø·</button>
              <button id="newBtn" class="btn ghost">â­ï¸ Ø³Ø¤Ø§Ù„ Ø¬Ø¯ÙŠØ¯</button>
              <button id="checkBtn" class="btn check-btn">ØªØ­Ù‚Ù‚</button>
            </div>
            <div class="feedback" id="feedback"></div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- modal Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ© -->
  <div id="resultModal" class="modal" role="dialog" aria-hidden="true">
    <div class="modal-box">
      <h2>ğŸ‰ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù„Ø¹Ø¨Ø©!</h2>
      <div style="margin-top:8px">Ù†ØªÙŠØ¬ØªÙƒ: <strong id="finalScore">0</strong> / 100</div>
      <div style="margin-top:8px">ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ø£Ø¯Ø§Ø¡: <div class="rating" id="ratingText">â€”</div></div>
      <div class="celebrate-emoji" id="celebrateEmoji">ğŸ‰</div>
      <div style="margin-top:12px">
        <button id="playAgain" class="btn">ğŸ” Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨</button>
        <button id="closeModal" class="btn ghost">Ø¥ØºÙ„Ø§Ù‚</button>
      </div>
    </div>
  </div>

<script>
/* ================== Ø¨ÙŠØ§Ù†Ø§Øª 100 Ø¬Ù…Ù„Ø© ==================
   ÙƒÙ„ Ø¹Ù†ØµØ±: {en, ar, words: [...]}
   (100 Ø¬Ù…Ù„Ø© ÙŠÙˆÙ…ÙŠØ© Ù…Ø¨Ø³Ø·Ø©)
*/
const SENTENCES = [
{en:"I am happy", ar:"Ø£Ù†Ø§ Ø³Ø¹ÙŠØ¯", words:["I","am","happy"]},
{en:"She is at school", ar:"Ù‡ÙŠ ÙÙŠ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©", words:["She","is","at","school"]},
{en:"What is your name?", ar:"Ù…Ø§ Ø§Ø³Ù…ÙƒØŸ", words:["What","is","your","name?"]},
{en:"He likes to play", ar:"Ù‡Ùˆ ÙŠØ­Ø¨ Ø£Ù† ÙŠÙ„Ø¹Ø¨", words:["He","likes","to","play"]},
{en:"We are friends", ar:"Ù†Ø­Ù† Ø£ØµØ¯Ù‚Ø§Ø¡", words:["We","are","friends"]},
{en:"They go to work", ar:"Ù‡Ù… ÙŠØ°Ù‡Ø¨ÙˆÙ† Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù…Ù„", words:["They","go","to","work"]},
{en:"I love my family", ar:"Ø£Ù†Ø§ Ø£Ø­Ø¨ Ø¹Ø§Ø¦Ù„ØªÙŠ", words:["I","love","my","family"]},
{en:"She drinks water", ar:"Ù‡ÙŠ ØªØ´Ø±Ø¨ Ù…Ø§Ø¡", words:["She","drinks","water"]},
{en:"Open the door please", ar:"Ø§ÙØªØ­ Ø§Ù„Ø¨Ø§Ø¨ Ù…Ù† ÙØ¶Ù„Ùƒ", words:["Open","the","door","please"]},
{en:"Close the window", ar:"Ø£ØºÙ„Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø©", words:["Close","the","window"]},
{en:"I eat breakfast", ar:"Ø£Ù†Ø§ Ø£ØªÙ†Ø§ÙˆÙ„ Ø§Ù„Ø¥ÙØ·Ø§Ø±", words:["I","eat","breakfast"]},
{en:"He reads a book", ar:"Ù‡Ùˆ ÙŠÙ‚Ø±Ø£ ÙƒØªØ§Ø¨Ù‹Ø§", words:["He","reads","a","book"]},
{en:"She is my teacher", ar:"Ù‡ÙŠ Ù…Ø¹Ù„Ù…ØªÙŠ", words:["She","is","my","teacher"]},
{en:"We play football", ar:"Ù†Ù„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…", words:["We","play","football"]},
{en:"They are at home", ar:"Ù‡Ù… ÙÙŠ Ø§Ù„Ù…Ù†Ø²Ù„", words:["They","are","at","home"]},
{en:"I need help", ar:"Ø£Ø­ØªØ§Ø¬ Ù…Ø³Ø§Ø¹Ø¯Ø©", words:["I","need","help"]},
{en:"Do you speak English?", ar:"Ù‡Ù„ ØªØªÙƒÙ„Ù… Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©ØŸ", words:["Do","you","speak","English?"]},
{en:"He is a good doctor", ar:"Ù‡Ùˆ Ø·Ø¨ÙŠØ¨ Ø¬ÙŠØ¯", words:["He","is","a","good","doctor"]},
{en:"She likes music", ar:"Ù‡ÙŠ ØªØ­Ø¨ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰", words:["She","likes","music"]},
{en:"I have a car", ar:"Ù„Ø¯ÙŠ Ø³ÙŠØ§Ø±Ø©", words:["I","have","a","car"]},
{en:"They want to eat", ar:"Ù‡Ù… ÙŠØ±ÙŠØ¯ÙˆÙ† Ø£Ù† ÙŠØ£ÙƒÙ„ÙˆØ§", words:["They","want","to","eat"]},
{en:"Please sit down", ar:"Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø¬Ù„ÙˆØ³", words:["Please","sit","down"]},
{en:"Stand up now", ar:"Ù‚Ù Ø§Ù„Ø¢Ù†", words:["Stand","up","now"]},
{en:"Walk to the park", ar:"Ø§Ù…Ø´Ù Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©", words:["Walk","to","the","park"]},
{en:"Run fast", ar:"Ø§Ø±ÙƒØ¶ Ø¨Ø³Ø±Ø¹Ø©", words:["Run","fast"]},
{en:"I am tired", ar:"Ø£Ù†Ø§ Ù…ØªØ¹Ø¨", words:["I","am","tired"]},
{en:"She is very kind", ar:"Ù‡ÙŠ Ø·ÙŠØ¨Ø© Ø¬Ø¯Ù‹Ø§", words:["She","is","very","kind"]},
{en:"He can swim", ar:"Ù‡Ùˆ ÙŠØ³ØªØ·ÙŠØ¹ Ø§Ù„Ø³Ø¨Ø§Ø­Ø©", words:["He","can","swim"]},
{en:"We read together", ar:"Ù†Ù‚Ø±Ø£ Ù…Ø¹Ù‹Ø§", words:["We","read","together"]},
{en:"They watch TV", ar:"Ù‡Ù… ÙŠØ´Ø§Ù‡Ø¯ÙˆÙ† Ø§Ù„ØªÙ„ÙØ§Ø²", words:["They","watch","TV"]},
{en:"I like coffee", ar:"Ø£Ø­Ø¨ Ø§Ù„Ù‚Ù‡ÙˆØ©", words:["I","like","coffee"]},
{en:"She cooks dinner", ar:"Ù‡ÙŠ ØªØ·Ø¨Ø® Ø§Ù„Ø¹Ø´Ø§Ø¡", words:["She","cooks","dinner"]},
{en:"He opens the book", ar:"Ù‡Ùˆ ÙŠÙØªØ­ Ø§Ù„ÙƒØªØ§Ø¨", words:["He","opens","the","book"]},
{en:"Close the door", ar:"Ø£ØºÙ„Ù‚ Ø§Ù„Ø¨Ø§Ø¨", words:["Close","the","door"]},
{en:"I go to school", ar:"Ø£Ø°Ù‡Ø¨ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø¯Ø±Ø³Ø©", words:["I","go","to","school"]},
{en:"She studies hard", ar:"Ù‡ÙŠ ØªØ¯Ø±Ø³ Ø¨Ø¬Ø¯", words:["She","studies","hard"]},
{en:"He writes a letter", ar:"Ù‡Ùˆ ÙŠÙƒØªØ¨ Ø±Ø³Ø§Ù„Ø©", words:["He","writes","a","letter"]},
{en:"We eat together", ar:"Ù†Ø£ÙƒÙ„ Ù…Ø¹Ù‹Ø§", words:["We","eat","together"]},
{en:"They play games", ar:"Ù‡Ù… ÙŠÙ„Ø¹Ø¨ÙˆÙ† Ø£Ù„Ø¹Ø§Ø¨Ù‹Ø§", words:["They","play","games"]},
{en:"I wash my hands", ar:"Ø£ØºØ³Ù„ ÙŠØ¯ÙŠ", words:["I","wash","my","hands"]},
{en:"Please be quiet", ar:"Ù…Ù† ÙØ¶Ù„Ùƒ ÙƒÙ† Ù‡Ø§Ø¯Ø¦Ø§", words:["Please","be","quiet"]},
{en:"Do your homework", ar:"Ù‚Ù… Ø¨ÙˆØ§Ø¬Ø¨Ùƒ", words:["Do","your","homework"]},
{en:"He has two brothers", ar:"Ù„Ù‡ Ø£Ø®ÙˆØ§Ù†", words:["He","has","two","brothers"]},
{en:"She needs a pencil", ar:"Ù‡ÙŠ ØªØ­ØªØ§Ø¬ Ù‚Ù„Ù… Ø±ØµØ§Øµ", words:["She","needs","a","pencil"]},
{en:"I opened the window", ar:"ÙØªØ­Øª Ø§Ù„Ù†Ø§ÙØ°Ø©", words:["I","opened","the","window"]},
{en:"We visited the zoo", ar:"Ø²Ø±Ù†Ø§ Ø­Ø¯ÙŠÙ‚Ø© Ø§Ù„Ø­ÙŠÙˆØ§Ù†", words:["We","visited","the","zoo"]},
{en:"They bought food", ar:"Ø§Ø´ØªØ±ÙˆØ§ Ø·Ø¹Ø§Ù…Ø§", words:["They","bought","food"]},
{en:"I like this song", ar:"Ø£Ù†Ø§ Ø£Ø­Ø¨ Ù‡Ø°Ù‡ Ø§Ù„Ø£ØºÙ†ÙŠØ©", words:["I","like","this","song"]},
{en:"She does exercise", ar:"Ù‡ÙŠ ØªÙ…Ø§Ø±Ø³ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©", words:["She","does","exercise"]},
{en:"He plays the piano", ar:"Ù‡Ùˆ ÙŠØ¹Ø²Ù Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ùˆ", words:["He","plays","the","piano"]},
{en:"We drink milk", ar:"Ù†Ø­Ù† Ù†Ø´Ø±Ø¨ Ø§Ù„Ø­Ù„ÙŠØ¨", words:["We","drink","milk"]},
{en:"They arrive early", ar:"ÙˆØµÙ„ÙˆØ§ Ù…Ø¨ÙƒØ±Ø§Ù‹", words:["They","arrive","early"]},
{en:"I open the book", ar:"Ø£ÙØªØ­ Ø§Ù„ÙƒØªØ§Ø¨", words:["I","open","the","book"]},
{en:"She wears a dress", ar:"Ù‡ÙŠ ØªØ±ØªØ¯ÙŠ ÙØ³ØªØ§Ù†Ø§", words:["She","wears","a","dress"]},
{en:"He cleans his room", ar:"Ù‡Ùˆ ÙŠÙ†Ø¸Ù ØºØ±ÙØªÙ‡", words:["He","cleans","his","room"]},
{en:"We enjoy summer", ar:"Ù†Ø³ØªÙ…ØªØ¹ Ø¨Ø§Ù„ØµÙŠÙ", words:["We","enjoy","summer"]},
{en:"They drive a car", ar:"Ù‡Ù… ÙŠÙ‚ÙˆØ¯ÙˆÙ† Ø³ÙŠØ§Ø±Ø©", words:["They","drive","a","car"]},
{en:"I lost my keys", ar:"ÙÙ‚Ø¯Øª Ù…ÙØ§ØªÙŠØ­ÙŠ", words:["I","lost","my","keys"]},
{en:"She found a coin", ar:"ÙˆØ¬Ø¯Øª Ø¹Ù…Ù„Ø©", words:["She","found","a","coin"]},
{en:"He broke the toy", ar:"ÙƒØ³Ø± Ø§Ù„Ù„Ø¹Ø¨Ø©", words:["He","broke","the","toy"]},
{en:"We make coffee", ar:"Ù†Ø¹Ø¯ Ø§Ù„Ù‚Ù‡ÙˆØ©", words:["We","make","coffee"]},
{en:"They clean the house", ar:"ÙŠÙ†Ø¸ÙÙˆÙ† Ø§Ù„Ù…Ù†Ø²Ù„", words:["They","clean","the","house"]},
{en:"I like to read", ar:"Ø£Ø­Ø¨ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©", words:["I","like","to","read"]},
{en:"She listens to music", ar:"Ù‡ÙŠ ØªØ³ØªÙ…Ø¹ Ù„Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰", words:["She","listens","to","music"]},
{en:"He sells fruit", ar:"Ù‡Ùˆ ÙŠØ¨ÙŠØ¹ Ø§Ù„ÙØ§ÙƒÙ‡Ø©", words:["He","sells","fruit"]},
{en:"We walk the dog", ar:"Ù†Ø®Ø±Ø¬ Ø§Ù„ÙƒÙ„Ø¨ Ù„Ù„Ù…Ø´ÙŠ", words:["We","walk","the","dog"]},
{en:"They swim in the sea", ar:"Ù‡Ù… ÙŠØ³Ø¨Ø­ÙˆÙ† ÙÙŠ Ø§Ù„Ø¨Ø­Ø±", words:["They","swim","in","the","sea"]},
{en:"I watch the stars", ar:"Ø£Ø´Ø§Ù‡Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ…", words:["I","watch","the","stars"]},
{en:"She plants a tree", ar:"ØªØ²Ø±Ø¹ Ø´Ø¬Ø±Ø©", words:["She","plants","a","tree"]},
{en:"He fixes the car", ar:"ÙŠØµÙ„Ø­ Ø§Ù„Ø³ÙŠØ§Ø±Ø©", words:["He","fixes","the","car"]},
{en:"We sing a song", ar:"Ù†ØºÙ†ÙŠ Ø£ØºÙ†ÙŠØ©", words:["We","sing","a","song"]},
{en:"They cook dinner", ar:"ÙŠØ·Ø¨Ø®ÙˆÙ† Ø§Ù„Ø¹Ø´Ø§Ø¡", words:["They","cook","dinner"]},
{en:"I visit my friend", ar:"Ø£Ø²ÙˆØ± ØµØ¯ÙŠÙ‚ÙŠ", words:["I","visit","my","friend"]},
{en:"She buys bread", ar:"ØªØ´ØªØ±ÙŠ Ø®Ø¨Ø²Ù‹Ø§", words:["She","buys","bread"]},
{en:"He pays the bill", ar:"ÙŠØ¯ÙØ¹ Ø§Ù„ÙØ§ØªÙˆØ±Ø©", words:["He","pays","the","bill"]},
{en:"We call the doctor", ar:"Ù†ØªØµÙ„ Ø¨Ø§Ù„Ø·Ø¨ÙŠØ¨", words:["We","call","the","doctor"]},
{en:"They travel by bus", ar:"ÙŠØ³Ø§ÙØ±ÙˆÙ† Ø¨Ø§Ù„Ø­Ø§ÙÙ„Ø©", words:["They","travel","by","bus"]},
{en:"I wake up early", ar:"Ø£Ø³ØªÙŠÙ‚Ø¸ Ù…Ø¨ÙƒØ±Ø§Ù‹", words:["I","wake","up","early"]},
{en:"She brushes her teeth", ar:"ØªÙ†Ø¸Ù Ø£Ø³Ù†Ø§Ù†Ù‡Ø§", words:["She","brushes","her","teeth"]},
{en:"He wears a hat", ar:"Ù‡Ùˆ ÙŠØ±ØªØ¯ÙŠ Ù‚Ø¨Ø¹Ø©", words:["He","wears","a","hat"]},
{en:"We paint the wall", ar:"Ù†Ø·Ù„ÙŠ Ø§Ù„Ø­Ø§Ø¦Ø·", words:["We","paint","the","wall"]},
{en:"They feed the cat", ar:"ÙŠØ·Ø¹Ù…ÙˆÙ† Ø§Ù„Ù‚Ø·Ø©", words:["They","feed","the","cat"]},
{en:"I bought a gift", ar:"Ø§Ø´ØªØ±ÙŠØª Ù‡Ø¯ÙŠØ©", words:["I","bought","a","gift"]},
{en:"She opened the box", ar:"ÙØªØ­Øª Ø§Ù„ØµÙ†Ø¯ÙˆÙ‚", words:["She","opened","the","box"]},
{en:"He closed the shop", ar:"Ø£ØºÙ„Ù‚ Ø§Ù„Ù…ØªØ¬Ø±", words:["He","closed","the","shop"]},
{en:"We learned English", ar:"ØªØ¹Ù„Ù…Ù†Ø§ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©", words:["We","learned","English"]},
{en:"They speak slowly", ar:"ÙŠØªÙƒÙ„Ù…ÙˆÙ† Ø¨Ø¨Ø·Ø¡", words:["They","speak","slowly"]},
{en:"I enjoy the movie", ar:"Ø§Ø³ØªÙ…ØªØ¹Øª Ø¨Ø§Ù„ÙÙŠÙ„Ù…", words:["I","enjoy","the","movie"]},
{en:"She likes chocolate", ar:"ØªØ­Ø¨ Ø§Ù„Ø´ÙˆÙƒÙˆÙ„Ø§ØªØ©", words:["She","likes","chocolate"]},
{en:"He studies every day", ar:"ÙŠØ¯Ø±Ø³ ÙƒÙ„ ÙŠÙˆÙ…", words:["He","studies","every","day"]},
{en:"We dance at night", ar:"Ù†Ø±Ù‚Øµ ÙÙŠ Ø§Ù„Ù„ÙŠÙ„", words:["We","dance","at","night"]},
{en:"They celebrate together", ar:"ÙŠØ­ØªÙÙ„ÙˆÙ† Ù…Ø¹Ù‹Ø§", words:["They","celebrate","together"]},
{en:"I keep my promise", ar:"Ø£ÙÙŠ Ø¨ÙˆØ¹Ø¯ÙŠ", words:["I","keep","my","promise"]},
{en:"She tells a story", ar:"ØªØ­ÙƒÙŠ Ù‚ØµØ©", words:["She","tells","a","story"]},
{en:"He opens his bag", ar:"ÙŠÙØªØ­ Ø­Ù‚ÙŠØ¨ØªÙ‡", words:["He","opens","his","bag"]},
{en:"We share our food", ar:"Ù†Ø´Ø§Ø±Ùƒ Ø·Ø¹Ø§Ù…Ù†Ø§", words:["We","share","our","food"]},
{en:"They enjoy the trip", ar:"ÙŠØ³ØªÙ…ØªØ¹ÙˆÙ† Ø¨Ø§Ù„Ø±Ø­Ù„Ø©", words:["They","enjoy","the","trip"]},
{en:"I lock the door", ar:"Ø£Ù‚ÙÙ„ Ø§Ù„Ø¨Ø§Ø¨", words:["I","lock","the","door"]},
{en:"She waters the plants", ar:"ØªØ³Ù‚ÙŠ Ø§Ù„Ù†Ø¨Ø§ØªØ§Øª", words:["She","waters","the","plants"]},
{en:"He cleans the kitchen", ar:"ÙŠÙ†Ø¸Ù Ø§Ù„Ù…Ø·Ø¨Ø®", words:["He","cleans","the","kitchen"]},
{en:"We open presents", ar:"Ù†ÙØªØ­ Ø§Ù„Ù‡Ø¯Ø§ÙŠØ§", words:["We","open","presents"]},
{en:"They run in the park", ar:"ÙŠØ±ÙƒØ¶ÙˆÙ† ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©", words:["They","run","in","the","park"]},
{en:"I say hello", ar:"Ø£Ù‚ÙˆÙ„ Ù…Ø±Ø­Ø¨Ø§", words:["I","say","hello"]},
{en:"She asks a question", ar:"ØªØ·Ø±Ø­ Ø³Ø¤Ø§Ù„Ø§", words:["She","asks","a","question"]},
{en:"He answers politely", ar:"ÙŠØ¬ÙŠØ¨ Ø¨Ø£Ø¯Ø¨", words:["He","answers","politely"]},
{en:"We have fun", ar:"Ù†Ù‚Ø¶ÙŠ ÙˆÙ‚Øª Ù…Ù…ØªØ¹", words:["We","have","fun"]},
{en:"They learn new words", ar:"ÙŠØªØ¹Ù„Ù…ÙˆÙ† ÙƒÙ„Ù…Ø§Øª Ø¬Ø¯ÙŠØ¯Ø©", words:["They","learn","new","words"]},
{en:"I like summer", ar:"Ø£Ø­Ø¨ Ø§Ù„ØµÙŠÙ", words:["I","like","summer"]},
{en:"She studies at night", ar:"ØªØ¯Ø±Ø³ ÙÙŠ Ø§Ù„Ù„ÙŠÙ„", words:["She","studies","at","night"]},
{en:"He helps his mother", ar:"ÙŠØ³Ø§Ø¹Ø¯ ÙˆØ§Ù„Ø¯ØªÙ‡", words:["He","helps","his","mother"]},
{en:"We meet at noon", ar:"Ù†Ù„ØªÙ‚ÙŠ ÙÙŠ Ø§Ù„Ø¸Ù‡Ø±", words:["We","meet","at","noon"]},
{en:"They clean the room", ar:"ÙŠÙ†Ø¸ÙÙˆÙ† Ø§Ù„ØºØ±ÙØ©", words:["They","clean","the","room"]},
{en:"I call my dad", ar:"Ø£ØªØµÙ„ Ø¨ÙˆØ§Ù„Ø¯ÙŠ", words:["I","call","my","dad"]},
{en:"She paints a picture", ar:"ØªØ±Ø³Ù… Ù„ÙˆØ­Ø©", words:["She","paints","a","picture"]},
{en:"He carries a bag", ar:"ÙŠØ­Ù…Ù„ Ø­Ù‚ÙŠØ¨Ø©", words:["He","carries","a","bag"]},
{en:"We visit the museum", ar:"Ù†Ø²ÙˆØ± Ø§Ù„Ù…ØªØ­Ù", words:["We","visit","the","museum"]},
{en:"They enjoy the meal", ar:"ÙŠØ³ØªÙ…ØªØ¹ÙˆÙ† Ø¨Ø§Ù„ÙˆØ¬Ø¨Ø©", words:["They","enjoy","the","meal"]},
{en:"I write a note", ar:"Ø£ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø©", words:["I","write","a","note"]},
{en:"She takes a photo", ar:"ØªÙ„ØªÙ‚Ø· ØµÙˆØ±Ø©", words:["She","takes","a","photo"]},
{en:"He watches the birds", ar:"ÙŠØ´Ø§Ù‡Ø¯ Ø§Ù„Ø·ÙŠÙˆØ±", words:["He","watches","the","birds"]},
{en:"We plant flowers", ar:"Ù†Ø²Ø±Ø¹ Ø£Ø²Ù‡Ø§Ø±Ù‹Ø§", words:["We","plant","flowers"]},
{en:"They smile together", ar:"ÙŠØ¨ØªØ³Ù…ÙˆÙ† Ù…Ø¹Ù‹Ø§", words:["They","smile","together"]}
]; // Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø¬Ù…Ù„ Ù‡Ù†Ø§ = 100 ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§

/* ============ state ============ */
let index = 0; // current question index
let score = 0;
let muted = false;

/* UI refs */
const meterBar = document.getElementById('meterBar');
const progressText = document.getElementById('progressText');
const sentenceTranslation = document.getElementById('sentenceTranslation');
const sentencePrompt = document.getElementById('sentencePrompt');
const slotRow = document.getElementById('slotRow');
const wordPool = document.getElementById('wordPool');
const feedback = document.getElementById('feedback');
const shuffleBtn = document.getElementById('shuffleBtn');
const newBtn = document.getElementById('newBtn');
const checkBtn = document.getElementById('checkBtn');
const muteToggle = document.getElementById('muteToggle');

const resultModal = document.getElementById('resultModal');
const finalScoreEl = document.getElementById('finalScore');
const ratingText = document.getElementById('ratingText');
const celebrateEmoji = document.getElementById('celebrateEmoji');
const playAgain = document.getElementById('playAgain');
const closeModal = document.getElementById('closeModal');

muteToggle.addEventListener('click', ()=>{
  muted = !muted;
  muteToggle.textContent = muted ? 'ğŸ”‡ ÙƒØªÙ…' : 'ğŸ”Š ØªØ´ØºÙŠÙ„';
});

/* helper */
function shuffle(arr){ return arr.slice().sort(()=>Math.random()-0.5); }
function speak(text, lang='en-US', rate=0.95){
  if(muted) return;
  if(!('speechSynthesis' in window)) return;
  const ut = new SpeechSynthesisUtterance(text);
  ut.lang = lang;
  ut.rate = rate;
  // try to pick english voice for en-US
  const voices = speechSynthesis.getVoices();
  if(voices && voices.length){
    const v = voices.find(v=>/en-(US|GB)|English/i.test((v.lang||'')+' '+(v.name||''))) || voices.find(v=>/en/i.test(v.lang)) || voices[0];
    if(v) ut.voice = v;
  }
  speechSynthesis.cancel();
  speechSynthesis.speak(ut);
}

/* confetti simple implementation */
const confettiCanvas = document.getElementById('confettiCanvas');
const ctx = confettiCanvas.getContext('2d');
let confettiPieces = [];
function resizeCanvas(){ confettiCanvas.width = window.innerWidth; confettiCanvas.height = window.innerHeight; }
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

function createConfetti(){
  confettiPieces = [];
  const colors = ['#ff5f6d','#ffc371','#47b78a','#06b6d4','#3b82f6','#9b5de5'];
  for(let i=0;i<120;i++){
    confettiPieces.push({
      x: Math.random()*confettiCanvas.width,
      y: Math.random()*-confettiCanvas.height,
      r: 6+Math.random()*8,
      dx: -2 + Math.random()*4,
      dy: 2 + Math.random()*6,
      color: colors[Math.floor(Math.random()*colors.length)],
      rot: Math.random()*360,
      drot: -5 + Math.random()*10
    });
  }
  runConfetti();
}

let confettiRunning = false;
function runConfetti(){
  confettiRunning = true;
  let t0 = performance.now();
  function frame(now){
    const dt = (now - t0)/1000;
    t0 = now;
    ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height);
    confettiPieces.forEach(p=>{
      p.x += p.dx;
      p.y += p.dy;
      p.rot += p.drot;
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot * Math.PI/180);
      ctx.fillStyle = p.color;
      ctx.fillRect(-p.r/2, -p.r/2, p.r, p.r*0.6);
      ctx.restore();
    });
    confettiPieces = confettiPieces.filter(p=> p.y < confettiCanvas.height + 30);
    if(confettiPieces.length>0) requestAnimationFrame(frame);
    else { confettiRunning = false; ctx.clearRect(0,0,confettiCanvas.width, confettiCanvas.height); }
  }
  requestAnimationFrame(frame);
}

/* ========== rendering question ========== */
let poolWords = [];
let slots = [];

function updateProgressUI(){
  const total = SENTENCES.length;
  meterBar.style.width = `${Math.round((index/total)*100)}%`;
  progressText.textContent = `${index} / ${total}`;
}

function renderQuestion(){
  feedback.textContent = '';
  if(index >= SENTENCES.length){
    // finish
    showResult();
    return;
  }
  updateProgressUI();
  const current = SENTENCES[index];
  sentenceTranslation.textContent = current.ar;
  sentencePrompt.textContent = current.en.replace(/\?/g,'?'); // display sentence (optional)
  // speak sentence
  speak(current.en, 'en-US', 0.95);

  // prepare pool: correct words (shuffled) plus maybe 1 distractor sometimes
  poolWords = shuffle(current.words.map((w,i)=> ({text:w, id:i})));
  // occasionally add distractor words to increase challenge
  if(Math.random() < 0.12){
    const extra = WORDS_sample_random(); // small helper to get a random simple word
    poolWords.push({text:extra, id:-1});
  }
  poolWords = shuffle(poolWords);
  slots = new Array(current.words.length).fill(null);

  // render slots
  slotRow.innerHTML = '';
  for(let i=0;i<slots.length;i++){
    const s = document.createElement('div');
    s.className = 'slot';
    s.dataset.index = i;
    s.addEventListener('dragover', e=> e.preventDefault());
    s.addEventListener('drop', e=>{
      e.preventDefault();
      const pi = Number(e.dataTransfer.getData('text/plain'));
      placeFromPoolByIndex(pi, i);
    });
    s.addEventListener('click', ()=> {
      // if filled -> return to pool
      if(slots[i] !== null){
        poolWords.push({text: slots[i], id:-1});
        slots[i] = null;
        renderPool();
        renderSlots();
      }
    });
    slotRow.appendChild(s);
  }

  renderPool();
  renderSlots();
}

function WORDS_sample_random(){
  // small list of common single words as possible distractors
  const extras = ["please","today","soon","again","very","fast","slow","nice","big","small","now"];
  return extras[Math.floor(Math.random()*extras.length)];
}

function renderPool(){
  wordPool.innerHTML = '';
  poolWords.forEach((pw, idx)=>{
    const el = document.createElement('div');
    el.className = 'word-pill';
    el.draggable = true;
    el.dataset.idx = idx;
    el.textContent = pw.text;
    el.addEventListener('dragstart', (ev)=>{
      ev.dataTransfer.setData('text/plain', idx);
      el.classList.add('dragging');
    });
    el.addEventListener('dragend', ()=> el.classList.remove('dragging'));
    el.addEventListener('click', ()=>{
      // place into first empty slot
      const firstEmpty = slots.indexOf(null);
      if(firstEmpty === -1) return;
      placeFromPoolByIndex(idx, firstEmpty);
    });
    wordPool.appendChild(el);
  });
}

function placeFromPoolByIndex(poolIndex, slotIndex){
  if(poolIndex < 0 || poolIndex >= poolWords.length) return;
  const w = poolWords[poolIndex].text;
  poolWords.splice(poolIndex,1);
  slots[slotIndex] = w;
  renderPool();
  renderSlots();
}

function renderSlots(){
  Array.from(slotRow.children).forEach((el,i)=>{
    const val = slots[i];
    el.textContent = val ? val : '';
    el.classList.toggle('placed', !!val);
  });
}

/* check logic */
checkBtn.addEventListener('click', checkAnswer);

function checkAnswer(){
  // ensure all slots filled
  if(slots.includes(null)){
    feedback.textContent = 'Ø§Ù„Ù…Ø±Ø¬Ùˆ Ù…Ù„Ø¡ ÙƒÙ„ Ø§Ù„Ø®Ø§Ù†Ø§Øª Ø£ÙˆÙ„Ø§Ù‹';
    feedback.className = 'feedback bad';
    speak('Please fill all slots', 'en-US', 1);
    return;
  }
  const user = slots.slice();
  const correct = SENTENCES[index].words.slice();
  // normalize punctuation spacing for comparison
  const userStr = user.join(' ').trim();
  const correctStr = correct.join(' ').trim();
  if(userStr === correctStr){
    // correct
    feedback.textContent = 'âœ… Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©';
    feedback.className = 'feedback ok';
    score++;
    // speak positive
    speak('Correct', 'en-US', 1.0);
    // update progress and auto-next
    index++;
    updateProgressUI();
    // celebration small effect (flash)
    slotRow.classList.add('celebrate');
    setTimeout(()=> slotRow.classList.remove('celebrate'), 350);
    // auto next after brief delay
    setTimeout(()=> {
      if(index < SENTENCES.length) renderQuestion();
      else showResult();
    }, 900);
  } else {
    // wrong
    feedback.textContent = 'âŒ ØªØ±ØªÙŠØ¨ Ø®Ø§Ø·Ø¦ â€” Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';
    feedback.className = 'feedback bad';
    // speak wrong
    speak('Wrong. Try again', 'en-US', 1.0);
    // shake
    slotRow.classList.add('shake');
    setTimeout(()=> slotRow.classList.remove('shake'), 480);
  }
}

/* shuffle and new question */
shuffleBtn.addEventListener('click', ()=>{
  poolWords = shuffle(poolWords);
  renderPool();
});
newBtn.addEventListener('click', ()=>{
  index++;
  if(index >= SENTENCES.length) showResult(); else renderQuestion();
});

/* result display */
function showResult(){
  finalScoreEl.textContent = score;
  // rating thresholds (adjustable)
  const percent = Math.round((score / SENTENCES.length) * 100);
  let rating = '';
  if(percent < 50) rating = 'Ø¶Ø¹ÙŠÙ';
  else if(percent < 70) rating = 'Ù…ØªÙˆØ³Ø·';
  else if(percent < 90) rating = 'Ø¬ÙŠØ¯';
  else rating = 'Ø¬ÙŠØ¯ Ø¬Ø¯Ù‹Ø§';
  ratingText.textContent = `${rating} â€” ${percent}%`;
  // emoji
  if(percent < 50) celebrateEmoji.textContent = 'ğŸ™‚';
  else if(percent < 70) celebrateEmoji.textContent = 'ğŸ–ï¸';
  else if(percent < 90) celebrateEmoji.textContent = 'ğŸ†';
  else celebrateEmoji.textContent = 'ğŸ‰ğŸ…';
  // show modal
  resultModal.classList.add('open');
  // confetti and sound for high scores
  if(percent >= 70){
    createConfetti();
    speak('Congratulations! You finished the game', 'en-US', 1.0);
  } else {
    speak('Game finished', 'en-US', 0.95);
  }
}

/* modal actions */
playAgain.addEventListener('click', ()=> {
  resultModal.classList.remove('open');
  index = 0; score = 0;
  updateProgressUI();
  renderQuestion();
});
closeModal.addEventListener('click', ()=> resultModal.classList.remove('open'));

/* keyboard shortcuts */
document.addEventListener('keydown', (e)=> {
  if(e.key === 'Enter') checkAnswer();
  if(e.key === ' ') { e.preventDefault(); /* space to speak current sentence */ const cur = SENTENCES[index]; if(cur) speak(cur.en); }
});

/* init voices for some browsers */
if (typeof speechSynthesis !== 'undefined') speechSynthesis.onvoiceschanged = ()=>{};

/* start */
renderQuestion();
updateProgressUI();
</script>
</body>
</html>
